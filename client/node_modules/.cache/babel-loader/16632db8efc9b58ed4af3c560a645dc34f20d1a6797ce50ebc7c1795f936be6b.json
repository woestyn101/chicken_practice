{"ast":null,"code":"import { __spreadArray } from \"tslib\";\nimport * as React from \"rehackt\";\nimport { useApolloClient } from \"./useApolloClient.js\";\nimport { getSuspenseCache, unwrapQueryRef, updateWrappedQueryRef, wrapQueryRef } from \"../internal/index.js\";\nimport { wrapHook } from \"./internal/index.js\";\nimport { useWatchQueryOptions } from \"./useSuspenseQuery.js\";\nimport { canonicalStringify } from \"../../cache/index.js\";\nexport function useBackgroundQuery(query, options) {\n  if (options === void 0) {\n    options = Object.create(null);\n  }\n  return wrapHook(\"useBackgroundQuery\", _useBackgroundQuery, useApolloClient(typeof options === \"object\" ? options.client : undefined))(query, options);\n}\nfunction _useBackgroundQuery(query, options) {\n  var client = useApolloClient(options.client);\n  var suspenseCache = getSuspenseCache(client);\n  var watchQueryOptions = useWatchQueryOptions({\n    client: client,\n    query: query,\n    options: options\n  });\n  var fetchPolicy = watchQueryOptions.fetchPolicy,\n    variables = watchQueryOptions.variables;\n  var _a = options.queryKey,\n    queryKey = _a === void 0 ? [] : _a;\n  // This ref tracks the first time query execution is enabled to determine\n  // whether to return a query ref or `undefined`. When initialized\n  // in a skipped state (either via `skip: true` or `skipToken`) we return\n  // `undefined` for the `queryRef` until the query has been enabled. Once\n  // enabled, a query ref is always returned regardless of whether the query is\n  // skipped again later.\n  var didFetchResult = React.useRef(fetchPolicy !== \"standby\");\n  didFetchResult.current || (didFetchResult.current = fetchPolicy !== \"standby\");\n  var cacheKey = __spreadArray([query, canonicalStringify(variables)], [].concat(queryKey), true);\n  var queryRef = suspenseCache.getQueryRef(cacheKey, function () {\n    return client.watchQuery(watchQueryOptions);\n  });\n  var _b = React.useState(wrapQueryRef(queryRef)),\n    wrappedQueryRef = _b[0],\n    setWrappedQueryRef = _b[1];\n  if (unwrapQueryRef(wrappedQueryRef) !== queryRef) {\n    setWrappedQueryRef(wrapQueryRef(queryRef));\n  }\n  if (queryRef.didChangeOptions(watchQueryOptions)) {\n    var promise = queryRef.applyOptions(watchQueryOptions);\n    updateWrappedQueryRef(wrappedQueryRef, promise);\n  }\n  // Handle strict mode where the query ref might be disposed when useEffect\n  // runs twice. We add the queryRef back in the suspense cache so that the next\n  // render will reuse this queryRef rather than initializing a new instance.\n  // This also prevents issues where rerendering useBackgroundQuery after the\n  // queryRef has been disposed, either automatically or by unmounting\n  // useReadQuery will ensure the same queryRef is maintained.\n  React.useEffect(function () {\n    if (queryRef.disposed) {\n      suspenseCache.add(cacheKey, queryRef);\n    }\n    // Omitting the deps is intentional. This avoids stale closures and the\n    // conditional ensures we aren't running the logic on each render.\n  });\n  var fetchMore = React.useCallback(function (options) {\n    var promise = queryRef.fetchMore(options);\n    setWrappedQueryRef(wrapQueryRef(queryRef));\n    return promise;\n  }, [queryRef]);\n  var refetch = React.useCallback(function (variables) {\n    var promise = queryRef.refetch(variables);\n    setWrappedQueryRef(wrapQueryRef(queryRef));\n    return promise;\n  }, [queryRef]);\n  React.useEffect(function () {\n    return queryRef.softRetain();\n  }, [queryRef]);\n  return [didFetchResult.current ? wrappedQueryRef : void 0, {\n    fetchMore: fetchMore,\n    refetch: refetch\n  }];\n}","map":{"version":3,"names":["React","useApolloClient","getSuspenseCache","unwrapQueryRef","updateWrappedQueryRef","wrapQueryRef","wrapHook","useWatchQueryOptions","canonicalStringify","useBackgroundQuery","query","options","Object","create","_useBackgroundQuery","client","undefined","suspenseCache","watchQueryOptions","fetchPolicy","variables","_a","queryKey","didFetchResult","useRef","current","cacheKey","__spreadArray","concat","queryRef","getQueryRef","watchQuery","_b","useState","wrappedQueryRef","setWrappedQueryRef","didChangeOptions","promise","applyOptions","useEffect","disposed","add","fetchMore","useCallback","refetch","softRetain"],"sources":["C:\\Users\\zachc\\Documents\\bootcamp\\chicken_practice\\client\\node_modules\\@apollo\\src\\react\\hooks\\useBackgroundQuery.ts"],"sourcesContent":["import * as React from \"rehackt\";\nimport type {\n  DocumentNode,\n  FetchMoreQueryOptions,\n  OperationVariables,\n  TypedDocumentNode,\n  WatchQueryOptions,\n} from \"../../core/index.js\";\nimport { useApolloClient } from \"./useApolloClient.js\";\nimport {\n  getSuspenseCache,\n  unwrapQueryRef,\n  updateWrappedQueryRef,\n  wrapQueryRef,\n} from \"../internal/index.js\";\nimport type { CacheKey, QueryReference } from \"../internal/index.js\";\nimport type { BackgroundQueryHookOptions, NoInfer } from \"../types/types.js\";\nimport { wrapHook } from \"./internal/index.js\";\nimport { useWatchQueryOptions } from \"./useSuspenseQuery.js\";\nimport type { FetchMoreFunction, RefetchFunction } from \"./useSuspenseQuery.js\";\nimport { canonicalStringify } from \"../../cache/index.js\";\nimport type { DeepPartial } from \"../../utilities/index.js\";\nimport type { SkipToken } from \"./constants.js\";\n\nexport type UseBackgroundQueryResult<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n> = {\n  fetchMore: FetchMoreFunction<TData, TVariables>;\n  refetch: RefetchFunction<TData, TVariables>;\n};\n\ntype BackgroundQueryHookOptionsNoInfer<\n  TData,\n  TVariables extends OperationVariables,\n> = BackgroundQueryHookOptions<NoInfer<TData>, NoInfer<TVariables>>;\n\nexport function useBackgroundQuery<\n  TData,\n  TVariables extends OperationVariables,\n  TOptions extends Omit<BackgroundQueryHookOptions<TData>, \"variables\">,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & TOptions\n): [\n  (\n    | QueryReference<\n        TOptions[\"errorPolicy\"] extends \"ignore\" | \"all\" ?\n          TOptions[\"returnPartialData\"] extends true ?\n            DeepPartial<TData> | undefined\n          : TData | undefined\n        : TOptions[\"returnPartialData\"] extends true ? DeepPartial<TData>\n        : TData,\n        TVariables\n      >\n    | (TOptions[\"skip\"] extends boolean ? undefined : never)\n  ),\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n    returnPartialData: true;\n    errorPolicy: \"ignore\" | \"all\";\n  }\n): [\n  QueryReference<DeepPartial<TData> | undefined, TVariables>,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n    errorPolicy: \"ignore\" | \"all\";\n  }\n): [\n  QueryReference<TData | undefined, TVariables>,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n    skip: boolean;\n    returnPartialData: true;\n  }\n): [\n  QueryReference<DeepPartial<TData>, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n    returnPartialData: true;\n  }\n): [\n  QueryReference<DeepPartial<TData>, TVariables>,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n    skip: boolean;\n  }\n): [\n  QueryReference<TData, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: BackgroundQueryHookOptionsNoInfer<TData, TVariables>\n): [\n  QueryReference<TData, TVariables>,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options: SkipToken\n): [undefined, UseBackgroundQueryResult<TData, TVariables>];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options:\n    | SkipToken\n    | (BackgroundQueryHookOptionsNoInfer<TData, TVariables> & {\n        returnPartialData: true;\n      })\n): [\n  QueryReference<DeepPartial<TData>, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: SkipToken | BackgroundQueryHookOptionsNoInfer<TData, TVariables>\n): [\n  QueryReference<TData, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n];\n\nexport function useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options:\n    | (SkipToken &\n        Partial<BackgroundQueryHookOptionsNoInfer<TData, TVariables>>)\n    | BackgroundQueryHookOptionsNoInfer<TData, TVariables> = Object.create(null)\n): [\n  QueryReference<TData, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n] {\n  return wrapHook(\n    \"useBackgroundQuery\",\n    _useBackgroundQuery,\n    useApolloClient(typeof options === \"object\" ? options.client : undefined)\n  )(query, options);\n}\n\nfunction _useBackgroundQuery<\n  TData = unknown,\n  TVariables extends OperationVariables = OperationVariables,\n>(\n  query: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options:\n    | (SkipToken &\n        Partial<BackgroundQueryHookOptionsNoInfer<TData, TVariables>>)\n    | BackgroundQueryHookOptionsNoInfer<TData, TVariables>\n): [\n  QueryReference<TData, TVariables> | undefined,\n  UseBackgroundQueryResult<TData, TVariables>,\n] {\n  const client = useApolloClient(options.client);\n  const suspenseCache = getSuspenseCache(client);\n  const watchQueryOptions = useWatchQueryOptions({ client, query, options });\n  const { fetchPolicy, variables } = watchQueryOptions;\n  const { queryKey = [] } = options;\n\n  // This ref tracks the first time query execution is enabled to determine\n  // whether to return a query ref or `undefined`. When initialized\n  // in a skipped state (either via `skip: true` or `skipToken`) we return\n  // `undefined` for the `queryRef` until the query has been enabled. Once\n  // enabled, a query ref is always returned regardless of whether the query is\n  // skipped again later.\n  const didFetchResult = React.useRef(fetchPolicy !== \"standby\");\n  didFetchResult.current ||= fetchPolicy !== \"standby\";\n\n  const cacheKey: CacheKey = [\n    query,\n    canonicalStringify(variables),\n    ...([] as any[]).concat(queryKey),\n  ];\n\n  const queryRef = suspenseCache.getQueryRef(cacheKey, () =>\n    client.watchQuery(watchQueryOptions as WatchQueryOptions<any, any>)\n  );\n\n  const [wrappedQueryRef, setWrappedQueryRef] = React.useState(\n    wrapQueryRef(queryRef)\n  );\n  if (unwrapQueryRef(wrappedQueryRef) !== queryRef) {\n    setWrappedQueryRef(wrapQueryRef(queryRef));\n  }\n  if (queryRef.didChangeOptions(watchQueryOptions)) {\n    const promise = queryRef.applyOptions(watchQueryOptions);\n    updateWrappedQueryRef(wrappedQueryRef, promise);\n  }\n\n  // Handle strict mode where the query ref might be disposed when useEffect\n  // runs twice. We add the queryRef back in the suspense cache so that the next\n  // render will reuse this queryRef rather than initializing a new instance.\n  // This also prevents issues where rerendering useBackgroundQuery after the\n  // queryRef has been disposed, either automatically or by unmounting\n  // useReadQuery will ensure the same queryRef is maintained.\n  React.useEffect(() => {\n    if (queryRef.disposed) {\n      suspenseCache.add(cacheKey, queryRef);\n    }\n    // Omitting the deps is intentional. This avoids stale closures and the\n    // conditional ensures we aren't running the logic on each render.\n  });\n\n  const fetchMore: FetchMoreFunction<TData, TVariables> = React.useCallback(\n    (options) => {\n      const promise = queryRef.fetchMore(options as FetchMoreQueryOptions<any>);\n\n      setWrappedQueryRef(wrapQueryRef(queryRef));\n\n      return promise;\n    },\n    [queryRef]\n  );\n\n  const refetch: RefetchFunction<TData, TVariables> = React.useCallback(\n    (variables) => {\n      const promise = queryRef.refetch(variables);\n\n      setWrappedQueryRef(wrapQueryRef(queryRef));\n\n      return promise;\n    },\n    [queryRef]\n  );\n\n  React.useEffect(() => queryRef.softRetain(), [queryRef]);\n\n  return [\n    didFetchResult.current ? wrappedQueryRef : void 0,\n    { fetchMore, refetch },\n  ];\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}